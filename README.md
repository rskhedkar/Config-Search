This code is prepared in python and might not be perfect for use. Please tune it to your requirements and then use. 
